$(function(){function e(){var e=!0;return""==$("#competition_title").val()?(0==$("#error_msg ul").has("#no_title").length&&$("#error_msg ul").append('<li id="no_title">Title can\'t be blank.</li>'),e=!1):(0!=$("#error_msg ul").has("#no_title").length&&$("#error_msg ul #no_title").remove(),$("#competition_title").val().match(/^[0-9a-zA-Z\s\.\-\_]+$/)?0!=$("#error_msg ul").has("#invalid_title").length&&$("#error_msg ul #invalid_title").remove():(0==$("#error_msg ul").has("#invalid_title").length&&$("#error_msg ul").append("<li id=\"invalid_title\">Title is invalid. It should not contain special characters other than '.', '-', '_'</li>"),e=!1)),""==$("#competition_period").val()?(0==$("#error_msg ul").has("#no_period").length&&$("#error_msg ul").append('<li id="no_period">You need to enter a period for the competition.</li>'),e=!1):0!=$("#error_msg ul").has("#no_period").length&&$("#error_msg ul #no_period").remove(),""==$("#competition_prize").val()?(0==$("#error_msg ul").has("#no_prize").length&&$("#error_msg ul").append('<li id="no_prize">You need to enter a prize for the competition.</li>'),e=!1):0!=$("#error_msg ul").has("#no_prize").length&&$("#error_msg ul #no_prize").remove(),""==$("#competition_prize_num").val()?(0==$("#error_msg ul").has("#no_prize_num").length&&$("#error_msg ul").append('<li id="no_prize_num">You need to enter a prize number for the competition.</li>'),e=!1):0!=$("#error_msg ul").has("#no_prize_num").length&&$("#error_msg ul #no_prize_num").remove(),""==$("#competition_poster").val()?(0==$("#error_msg ul").has("#no_poster").length&&$("#error_msg ul").append('<li id="no_poster">You need to upload a poster for the competition.</li>'),e=!1):0!=$("#error_msg ul").has("#no_poster").length&&$("#error_msg ul #no_prize_num").remove(),console.log(e),e}$(".directUploadCompetition").find("input:file").each(function(t,i){var o=$(i),r=$(o.parents("form:first")),n=$("#competition_poster"),a=r.find('input[type="submit"]'),l=/(\.|\/)(jpe?g|png){1}$/i,s=$("<div class='bar'></div>"),d=$("<div class='progress'></div>").append(s);o.after(d),o.fileupload({fileInput:o,url:r.data("url"),type:"POST",autoUpload:!1,formData:r.data("form-data"),paramName:"file",dataType:"XML",replaceFileInput:!1,add:function(t,i){var o=!0;0!=i.originalFiles[0].type.length&&l.test(i.originalFiles[0].type)||(o=!1,alert("The file format is not acceptable."),$(this).val("")),a.click(function(){e();console.log("submitButton"),o&&e()&&i.submit()})},progressall:function(e,t){var i=parseInt(t.loaded/t.total*100,10);s.css("width",i+"%").text("Loading...("+i+"%)")},start:function(){a.prop("disabled",!0),n.prop("disabled",!0),s.css("background","green").css("display","block").css("width","0%").text("Loading...")},done:function(e,t){s.text("Uploading done"),console.log("done");var i=$(t.jqXHR.responseXML).find("Key").text(),n="//"+r.data("host")+"/"+i,a=$("<input />",{type:"hidden",name:o.attr("name"),value:n});r.append(a),r.submit()},fail:function(){a.prop("disabled",!1),s.css("background","red").text("Failed")}})}),$(".directUploadCompetitionEdit").find("input:file").each(function(t,i){var o=$(i),r=$(o.parents("form:first")),n=$("#competition_poster_update"),a=r.find('input[type="submit"]'),l=/(\.|\/)(jpe?g|png){1}$/i,s=$("<div class='bar'></div>"),d=$("<div class='progress'></div>").append(s);o.after(d),o.fileupload({fileInput:o,url:r.data("url"),type:"POST",autoUpload:!1,formData:r.data("form-data"),paramName:"file",dataType:"XML",replaceFileInput:!1,add:function(t,i){var o=!0;0!=i.originalFiles[0].type.length&&l.test(i.originalFiles[0].type)||(o=!1,alert("The file format is not acceptable."),$(this).val("")),a.click(function(){e();console.log("submitButton"),o&&e()&&i.submit()})},progressall:function(e,t){var i=parseInt(t.loaded/t.total*100,10);s.css("width",i+"%").text("Loading...("+i+"%)")},start:function(){a.prop("disabled",!0),n.prop("disabled",!0),s.css("background","green").css("display","block").css("width","0%").text("Loading...")},done:function(e,t){s.text("Uploading done"),console.log("done");var i=$(t.jqXHR.responseXML).find("Key").text(),n="//"+r.data("host")+"/"+i,a=$("<input />",{type:"hidden",name:o.attr("name"),value:n});r.append(a),r.submit()},fail:function(){a.prop("disabled",!1),s.css("background","red").text("Failed")}})}),$(".directUploadCompetition").find('input[type="submit"]').click(function(t){e(),t.preventDefault()}),$(".video-browsing").find("input:submit").each(function(e,t){$(t).click(function(e){var t=$(this).parent().find("#post_video_id").val(),i=$(this).parent().find("#post_competition_id").val();$.ajax({url:$(this).parent().parent().attr("action"),method:$(this).parent().parent().attr("method"),data:{vid:t,id:i},success:function(e){if(null==e.error){var i=e.size;$(".right-content-heading-left h1 a").html(i+" Videos in List"),$("#add_video_to_competition_"+t).find('input[type="submit"]').attr("disabled","disabled"),$("#add_video_to_competition_"+t).find('input[type="submit"]').val("Added"),alert(e.msg)}else alert(e.error)},error:function(e,t,i){alert(i)}}),e.preventDefault()})})});